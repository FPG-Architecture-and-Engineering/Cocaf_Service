# ==========================
# General Options
# ==========================
Options -Indexes

RewriteEngine On

# ==========================
# HEALTH CHECK
# ==========================
# Prevent trailing slash redirect for /maintenance/health
RewriteCond %{REQUEST_URI} ^/maintenance/health/?$
RewriteRule ^maintenance/health/?$ index.php?controller=maintenance&view=health [NC,L]

# ==========================
# Trailing Slash Redirect (default)
# ==========================
RewriteCond %{REQUEST_URI} !(/$|\.)
RewriteRule (.*) %{REQUEST_URI}/ [R=301,L]

# ==========================
# Remove .php Extension
# ==========================
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME}\.php -f
RewriteRule ^(.*)/$ $1.php

# ==========================
# Template Renaming Folders
# ==========================
RewriteRule ^public/css/(.*) /template/style/$1 [NC,L]
RewriteRule ^public/img/(.*) /template/image/$1 [NC,L]
RewriteRule ^public/js/(.*) /template/javascript/$1 [NC,L]
RewriteRule ^public/scss/(.*) /template/scss/$1 [NC,L]
RewriteRule ^public/lib/(.*) /template/jquery/$1 [NC,L]
RewriteRule ^public/skins/(.*) /template/skins/$1 [NC,L]
RewriteRule ^public/font/(.*) /template/fonts/$1 [NC,L]

# ==========================
# Uploads
# ==========================
RewriteRule ^file/(.*) /upload/$1 [NC,L]

# ==========================
# Account
# ==========================
RewriteRule ^login/$ index.php?controller=account&view=login [NC,L]
RewriteRule ^logout/$ index.php?controller=account&view=logout [NC,L]

# ==========================
# COCAF API
# ==========================
RewriteRule ^api/cocaf/validate/?$ index.php?controller=api&view=validate [NC,L]

# ==========================
# UAT API
# ==========================
RewriteRule ^uat/api/cocaf/validate/?$ index.php?controller=uat&view=validate [NC,L]

# ==========================
# Default Routes
# ==========================
RewriteRule ^([a-z]+)/([^/]+)/?$ index.php?controller=$1&view=$2 [QSA]
RewriteRule ^([a-z]+)/?$ index.php?controller=$1&view=index [QSA]

# ==========================
# Error Pages
# ==========================
RewriteRule ^bad-request/$ index.php?controller=page&view=error400 [QSA]
RewriteRule ^unauthorized/$ index.php?controller=page&view=error401 [QSA]
RewriteRule ^forbidden/$ index.php?controller=page&view=error403 [QSA]
RewriteRule ^page-not-found/$ index.php?controller=page&view=error404 [QSA]
RewriteRule ^internal-server-error/$ index.php?controller=page&view=error500 [QSA]
RewriteRule ^coming-soon/$ index.php?controller=page&view=coming-soon [QSA]
RewriteRule ^under-maintenance/$ index.php?controller=page&view=under-maintenance [QSA]

# ==========================
# Apache Error Redirects
# ==========================
ErrorDocument 400 /bad-request/
ErrorDocument 401 /unauthorized/
ErrorDocument 403 /forbidden/
ErrorDocument 404 /page-not-found/
ErrorDocument 500 /internal-server-error/
